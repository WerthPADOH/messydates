d <- as_messydate(c("2008-03-25", "-2012-02-27", "2001-01?", "~2001",
                    "2001-01-01..2001-02-02", "{2001-01-01,2001-02-02}",
                    "..2002-02-03", "2001-01-03..", "28 BC"))
a <- as_messydate(c("2011-03-25", "-2015-02-26", "1998-01-02..2004-01-31",
                    "1995-01-03..2006-12-31", "1998-01-02..2004-02-02",
                    "{2004-01-01, 2004-02-02}", "..2005-02-02", "2004-01-03..",
                    "-0030-12-31..-0026-01-01"))
s <- as_messydate(c("2005-03-26", "-2009-02-27", "2004-01-01..1998-02-01",
                    "2001-01-01..2001-01-01", "2004-01-01..1998-02-03",
                    "{1998-01-02, 1998-02-03}", "..1999-02-04", "1998-01-04..",
                    "-0025-01-01..-0031-12-31"))

test_that("operations work properly", {
  expect_equal(add(d, 3), a)
  expect_equal(subtract(d, 3), s)
  expect_equal(add(as_messydate("2010-01-01"), 1, "month"),
               as_messydate("2010-01-31"))
  expect_equal(subtract(as_messydate("2010-02-01"), 1, "month"),
               as_messydate("2010-01-01"))
  expect_equal(add(as_messydate("2010-01-01"), 1, "day"),
               as_messydate("2010-01-02"))
  expect_equal(subtract(as_messydate("2010-01-02"), 1, "day"),
               as_messydate("2010-01-01"))
})
